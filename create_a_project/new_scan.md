# New Scan

This will start a new wizard for the scan. You may create multiple scans inside a single project. Each time you do, the scan wizard is started again.

![Scan overview (New Scan)](<../.gitbook/assets/image (146).png>)



## Scan configuration <a href="#scan-configuration" id="scan-configuration"></a>

In "Scan configuration" you must supply a description and you may optionally select the “Active” and “Save system context” flags:

![Scan configuration](<../.gitbook/assets/image (160).png>)

* ✔ “Active” means that the scan will be executed whenever the project is started for execution.

**IMPORTANT**

*   ✔ The flag “Save System context” means that the complete state of the target system will be recorded for each Scan. When this flag is not selected, it means that it is not possible to inspect the actual state of the target system during the time that the scan was executed.

    See [Appendix F](../appendix\_f\_system\_context.md) for a detailed description of the system context.
* ✔ The flag "Export to SIEM" means that a file will be produced after each Scan containing the vulnerabilities found. The location to which these files are exported can be specified in the [Application settings](https://vmuserguide.protect4s.com/check\_and\_set\_application\_settings). It is possible to select only those vulnerabilities that have a specific risk value or higher by using the value dropdown box under "SIEM export as from risk".

When done, press next in order to select a satellite system.

## System selection <a href="#system-selection" id="system-selection"></a>

**System selection**

In this step, you must select a target system. Press the selector button attached to the right hand side of the System ID field and a secondary list will open for which you may select any target system that was created earlier.

![Satellite system selection](<../.gitbook/assets/image (244).png>)

After selection, the system header data and that of the company that owns the system, will show:

![](<../.gitbook/assets/image (167).png>)

## Template selection <a href="#template-selection" id="template-selection"></a>

In the next step you may either select an existing check template or you may skip this and manually select the checks that will be executed on the target system.

![Check template selection](<../.gitbook/assets/image (224).png>)

If you select a template in this step, then it will run and execute the check with the default template values. You cannot change a template that has been delivered by Protect4S VM.

* ✔ Should you want to run all checks on a System, then it is recommended to use the check template #1: **"All Checks with default value"**. This ensures that all checks will always be run even after the delivery of new checks via a support package.
* ✔ Should you want to check your SAP systems against the SAP Security baseline then please choose the version of your choice or use the "**SAP security baseline version 2.2 - SAP Note** [**2253549**](https://launchpad.support.sap.com/#/notes/2253549)" template to always have the latest version.
* ✔ You can also [create your own check templates](../check-template.md) to check your SAP landscape against your own baseline.

Alternatively, you may skip the template selection and manually select the required checks:

## Check selection <a href="#check-selection" id="check-selection"></a>

![Check selection (Tree view)](<../.gitbook/assets/image (162).png>)

When this list is displayed, it means that the application has determined which check are suited to be executed on the target system. Protect4S VM has made a pre-selection of all available checks from its repository. For instance: no UNIX type Checks will be shown if the target System runs on Windows.

By selecting “Adapt check template” from the menu, it will be possible to select a template and adapt the values that it is checking against.

By selecting the Display type, it is possible to toggle between a “Tree” or a “Group / Subgroup” type overview. The latter overview shows a hierarchical selection possibility in which a subset of checks may be selected:

![Check overview (Group & subgroup view)](<../.gitbook/assets/image (227).png>)

For instance: In the picture above the subgroup "ABAP Security Notes" is selected. In the list overview in the bottom of the picture, only this category is shown.

In both views it is possible to select all available checks in one go by using the “Select all” button.

## Reference values <a href="#reference-values" id="reference-values"></a>

Some checks will execute a check against a reference value. For instance, the length of a SAP password as specified by SAP parameter _**login/min\_password\_lng**_ may be checked and compared with a reference value of 10.

However, if a company security policy dictates that the password length should be 9 characters instead of 10, then it is possible to change the reference value:

![Changing a check reference value](<../.gitbook/assets/image (149).png>)

The change can be made by selecting the pencil button in the record that belongs to the check. This will start a popup containing the reference value. This value can be changed and saved. After the change has been made, the check record is shown as:

![Check containing a changed reference value](<../.gitbook/assets/image (241).png>)

After changing the reference value, it is possible to identify the check because it now shows a change Icon next to it. If you click this indicator, the value will be reset to its standard, best practice value.

After all relevant checks have been selected and all relevant check reference values have been adapted, you may select the button “Back” and leave the scan wizard:

![Leave this Scan wizard and return to the Project configuration](<../.gitbook/assets/image (221).png>)

![Project configuration after creating the first scan](<../.gitbook/assets/image (196).png>)

Now you may either:

* Configure a new scan by pressing the "New" button
* Schedule or start the project directly by pressing the "Next" button.

## Scheduling the Project <a href="#scheduling-the-project" id="scheduling-the-project"></a>

The 3rd step in the project configuration is the "Schedule" step.

![Scheduling a Project](<../.gitbook/assets/image (159).png>)

It is possible to schedule a Project for:

* immediate execution (default)
* scheduled execution one-time at a later time
* repeated execution starting immediately
* repeated execution starting at a later time

By de-selecting the Immediate flag, it becomes possible to schedule the Project to run on a specific date and at a specific time:

![Scheduling options for a project](<../.gitbook/assets/image (166).png>)

In addition, by selection of the Periodic flag it becomes possible to select a suitable interval for repeated project execution. In order to activate the schedule, press the button " Back to project" and press the Save button. you will see the schedule data in the list:

![Saving a Project Schedule](<../.gitbook/assets/image (222).png>)

The project will be scheduled as a standard SAP Background job called **"/ESEC/SA**_**PROJECT**_**\<Project number>".**

The program that it runs is called: **/ESEC/SA\_PROJECT\_EXECUTOR** and the variant contains the number of the Project.
