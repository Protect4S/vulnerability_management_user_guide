---
description: Protect4S VM can be integrated with Incident Management solutions.
---

# Incident Management

## ServiceNow - Incident Management

### Prerequisites

The technical connection to be used must be created upfront so that it can be selected later. This is done as follows:

In the Protect4S system, start transaction SM59 and create an RFC destination of type type G as in the example shown below:

* Enter the details relevant for your ServiceNow instance (hostname, port, user and password).
* Select the SSL client PSE to use HTTPS for the connection. Make sure to trust the ServiceNow HTTPS endpoint by adding the relevant certificate to the Certificate List of the selected PSE (transaction STRUST).

<div align="left">

<figure><img src="../.gitbook/assets/image (254).png" alt=""><figcaption></figcaption></figure>

</div>

<div align="left">

<figure><img src="../.gitbook/assets/image (256).png" alt=""><figcaption></figcaption></figure>

</div>

Test the connection, this should be successful:

<div align="left">

<figure><img src="../.gitbook/assets/image (258).png" alt=""><figcaption></figcaption></figure>

</div>

### Create integration

To set up the integration, go to Integration, Incident Management:

![](<../.gitbook/assets/image (212).png>)

Click 'New' to setup a new integration:

<div align="left">

<figure><img src="../.gitbook/assets/image (252).png" alt=""><figcaption></figcaption></figure>

</div>

Use the settings like shown in the example below. Select the earlier created RFC destination as Connection name:

<div align="left">

<figure><img src="../.gitbook/assets/image (260).png" alt=""><figcaption></figcaption></figure>

</div>

Next, Scans can be added to the integration. Click the New button and add the scan of your choosing, like shown in the example below:

<figure><img src="../.gitbook/assets/image (262).png" alt=""><figcaption></figcaption></figure>

Next time the scan is run, incidents will be created for the failed checks, like shown in the example below.

Protect4S scan results:

<figure><img src="../.gitbook/assets/image (265).png" alt=""><figcaption></figcaption></figure>

ServiceNow incidents:

<figure><img src="../.gitbook/assets/image (264).png" alt=""><figcaption></figcaption></figure>

### Functionality

The ServiceNow (SNow) fields are mapped with the information from Protect4S VM as follows:

<table><thead><tr><th>ServiceNow field</th><th width="222.33333333333331">Protect4S field</th><th>Explanation</th></tr></thead><tbody><tr><td>Caller</td><td>-</td><td>Name value of the integration user.</td></tr><tr><td>Impact</td><td>Impact</td><td>The impact of the finding.</td></tr><tr><td>Urgency</td><td>Likelihood</td><td>Likelihood about the found risk/exploit.</td></tr><tr><td>Priority</td><td>-</td><td>Calculated by ServiceNow based on 'Impact' and 'Urgency'.</td></tr><tr><td>Short description</td><td>Check name &#x26; ID</td><td>The Name of the check plus ID is shown here.</td></tr><tr><td>Description</td><td>Date, time Run ID, Scan ID, System ID, SID &#x26; Check Message</td><td>Origin and details of the check.</td></tr></tbody></table>

The value mappings for Urgency - Likelihood and Impact - Impact do not completely align between Protect4S VM and ServiceNow for the values 'Very high' and 'Very low'.

The values are mapped as following:

| P4S Impact | SNow Impact | P4S Likelihood | SNow Urgency |
| ---------- | ----------- | -------------- | ------------ |
| Very high  | High        | Very high      | High         |
| High       | High        | High           | High         |
| Medium     | Medium      | Medium         | Medium       |
| Low        | Low         | Low            | Low          |
| Very low   | Low         | Very low       | Low          |

Incidents in ServiceNow are created based on configured Scans (see above). For each failed check of a run in a configured scan, either a new incident is created or the existing incident for the check is updated.&#x20;

See the example below where the check results of additional runs are added to the ServiceNow ticket Description (separated by dash lines) in case of an update:

<figure><img src="../.gitbook/assets/image (266).png" alt=""><figcaption></figcaption></figure>

